<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archives - NÃ©buleuse Visuelle (V100.9.30) - SECURED SYSTEM V2031</title>
    
    <script src="system-bridge.js"></script> 
    <script src="archives-data.js" onerror="logMessage('LOCAL_DATA_FAILURE', 'CRITICAL')"></script> 
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        :root { 
            --noir-fond: #050000; 
            --rouge-vif: #ff0033; 
            --rouge-dim: rgba(255, 0, 51, 0.2);
            --rose-hii: rgba(150, 0, 50, 0.15);
            --bleu-tech: #ff0033; 
            --standard-magenta: #ff00ff; 
            --cosplay-gold: #ffcc00;
            --bordeaux: #660011; 
            --active-glow: 0 0 20px rgba(255, 0, 51, 0.4);
            --font-main: 'Courier New', monospace;
        }

        body { 
            margin: 0; 
            background-color: var(--noir-fond); 
            color: white; 
            font-family: var(--font-main); 
            min-height: 100vh; 
            overflow-x: hidden;
            background-attachment: fixed; 
            scroll-behavior: smooth;
        }

        /* --- BACKGROUND ENGINE --- */
        .nebula-layer { 
            position: fixed; 
            inset: 0; 
            z-index: -20; 
            background: radial-gradient(circle at 10% 80%, var(--rose-hii) 0%, transparent 50%); 
        }
        
        .star-field { 
            position: fixed; 
            width: 300%; 
            height: 300%; 
            top: -100%; 
            left: -100%; 
            z-index: -15; 
            background-image: radial-gradient(1px 1px at 25px 35px, #fff, transparent), radial-gradient(2px 2px at 100px 150px, rgba(255,0,0,0.15), transparent); 
            background-size: 500px 500px, 300px 300px; 
            animation: spin 600s linear infinite; 
        }
        
        @keyframes spin { 
            from { transform: rotate(0deg); } 
            to { transform: rotate(360deg); } 
        }

        /* EFFET VHS / SCANLINE ROUGE */
        body::before {
            content: " "; 
            display: block; 
            position: fixed; 
            inset: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.3) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.05), rgba(50, 0, 0, 0.02), rgba(255, 0, 0, 0.05));
            z-index: 9999; 
            background-size: 100% 4px, 4px 100%; 
            pointer-events: none; 
            opacity: 0.7;
        }

        /* --- UI OVERLAY --- */
        .osd-header { 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            height: 60px; 
            background: rgba(10,0,0,0.95); 
            border-bottom: 1px solid var(--bordeaux);
            z-index: 10000; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 0 25px;
        }

        .btn-exit { 
            border: 1px solid var(--bordeaux); 
            color: var(--rouge-vif); 
            padding: 8px 15px; 
            font-size: 10px; 
            text-decoration: none; 
            transition: 0.3s; 
            background: rgba(50,0,0,0.2); 
        }
        
        .btn-exit:hover { 
            background: var(--rouge-vif); 
            color: white; 
            box-shadow: var(--active-glow); 
        }

        .sys-log { 
            position: fixed; 
            bottom: 20px; 
            left: 20px; 
            width: 250px; 
            font-size: 8px; 
            color: var(--rouge-vif); 
            z-index: 10000; 
            pointer-events: none; 
        }

        /* --- PLANETS FILTERS --- */
        .nav-planets { 
            position: fixed; 
            left: 20px; 
            top: 120px; 
            z-index: 10005; 
            display: flex; 
            flex-direction: column; 
            gap: 30px; 
        }
        
        .planet-box { 
            position: relative; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
        }
        
        .planet { 
            width: 45px; 
            height: 45px; 
            border-radius: 50%; 
            border: 1px solid rgba(255,255,255,0.2); 
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        
        .planet:hover { 
            transform: scale(1.2) rotate(15deg); 
            border-color: var(--rouge-vif); 
        }
        
        .planet.active { 
            border-color: var(--rouge-vif); 
            box-shadow: var(--active-glow); 
        }
        
        .p-gold { background: radial-gradient(circle at 30% 30%, #fff, var(--cosplay-gold), #600); }
        .p-blue { background: radial-gradient(circle at 30% 30%, #fff, #990000, #200); }
        .p-red { background: radial-gradient(circle at 30% 30%, #fff, var(--rouge-vif), #300); }
        
        .planet-label { 
            position: absolute; 
            left: 60px; 
            font-size: 9px; 
            opacity: 0; 
            transition: 0.3s; 
            white-space: nowrap; 
            color: var(--rouge-vif); 
            border-left: 2px solid var(--rouge-vif); 
            padding-left: 10px;
        }
        
        .planet-box:hover .planet-label { opacity: 1; }

        /* --- MASTER TOOLS SECTION --- */
        #master-tools { 
            display: none; 
            border: 2px solid var(--rouge-vif); 
            background: rgba(20,0,0,0.95); 
            padding: 25px; 
            margin-bottom: 40px;
            box-shadow: 0 0 30px rgba(255,0,0,0.2);
            position: relative;
            z-index: 2000;
        }

        .master-grid { 
            display: grid; 
            grid-template-columns: 350px 1fr; 
            gap: 20px; 
        }
        
        .canvas-3d { 
            width: 100%; 
            height: 350px; 
            background: #000; 
            border: 1px solid var(--bordeaux); 
            position: relative;
        }

        .btn-master { 
            background: var(--bordeaux); 
            color: white; 
            border: 1px solid var(--rouge-vif); 
            padding: 12px; 
            cursor: pointer; 
            font-family: inherit; 
            font-size: 10px; 
            transition: 0.3s; 
            text-transform: uppercase;
        }
        
        .btn-master:hover { 
            background: var(--rouge-vif); 
            box-shadow: var(--active-glow); 
        }

        /* --- ROMANS SELECTOR --- */
        #romans-selector { 
            display: flex; 
            gap: 15px; 
            overflow-x: auto; 
            padding: 20px; 
            background: rgba(255, 0, 50, 0.03); 
            border: 1px solid #200; 
            margin-bottom: 35px; 
            scrollbar-width: thin; 
            scrollbar-color: var(--rouge-vif) #000;
        }
        
        .roman-tab { 
            min-width: 260px; 
            padding: 15px; 
            background: #000; 
            border: 1px solid #222; 
            font-size: 9px; 
            cursor: pointer; 
            transition: 0.3s; 
            color: #666; 
            position: relative;
        }
        
        .roman-tab.active { 
            border-color: var(--rouge-vif); 
            color: var(--rouge-vif); 
            background: rgba(255,0,50,0.1); 
            border-left: 5px solid var(--rouge-vif); 
        }
        
        .roman-tab.master-only { 
            border-color: var(--bordeaux); 
            color: var(--bordeaux); 
            border-style: dashed; 
        }
        
        .tome-info { 
            font-size: 8px; 
            display: block; 
            margin-top: 5px; 
            color: var(--cosplay-gold); 
        }

        /* --- MAIN CONTENT & GRID --- */
        .container { 
            max-width: 1450px; 
            margin: 100px auto 50px 150px; /* DÃ©calage pour ne pas Ãªtre sous les planÃ¨tes */
            padding-right: 50px; 
        }
        
        .glitch-title { 
            font-size: 2.2rem; 
            text-transform: uppercase; 
            letter-spacing: 12px; 
            margin-bottom: 40px; 
            color: var(--rouge-vif);
            text-shadow: 2px 0 var(--bordeaux), -2px 0 var(--cosplay-gold); 
            animation: glitch-anim 3s infinite linear alternate-reverse;
        }
        
        @keyframes glitch-anim { 
            0% { transform: skew(0deg); } 
            50% { transform: skew(1deg); } 
            100% { transform: skew(-1deg); } 
        }

        .search-container {
            display: flex; 
            gap: 20px; 
            margin-bottom: 40px; 
            align-items: center; 
            background: rgba(255,0,0,0.02); 
            padding: 20px; 
            border-left: 4px solid var(--rouge-vif); 
            border-top: 1px solid #211;
        }
        
        #search { 
            background: none; 
            border: none; 
            color: white; 
            outline: none; 
            width: 100%; 
            font-family: inherit; 
            font-size: 14px; 
        }

        .archive-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); 
            gap: 25px; 
        }
        
        .box { 
            background: rgba(10,5,5,0.95); 
            border: 1px solid #200; 
            padding: 15px; 
            position: relative;
            transition: 0.3s; 
            clip-path: polygon(0 0, 95% 0, 100% 5%, 100% 100%, 5% 100%, 0 95%);
        }
        
        .box:hover { 
            transform: translateY(-5px); 
            border-color: var(--rouge-vif); 
            box-shadow: 0 10px 20px rgba(0,0,0,0.8); 
        }

        .image-frame { 
            width: 100%; 
            height: 400px; 
            background: #000; 
            position: relative; 
            border: 1px solid #100; 
            overflow: hidden; 
        }
        
        .card-hud { 
            position: absolute; 
            top: 5px; 
            right: 8px; 
            font-size: 7px; 
            color: var(--rouge-vif); 
            opacity: 0.7; 
            z-index: 10; 
        }
        
        .scanline { 
            position: absolute; 
            width: 100%; 
            height: 2px; 
            background: rgba(255, 0, 50, 0.2); 
            top: 0; 
            animation: scanMove 4s linear infinite; 
            z-index: 11; 
            pointer-events: none; 
        }
        
        @keyframes scanMove { 
            0% { top: 0; } 
            100% { top: 100%; } 
        }

        .badge-inedit { 
            position: absolute; 
            top: 0; 
            left: 0; 
            background: var(--bordeaux); 
            font-size: 8px; 
            padding: 5px 12px; 
            z-index: 20; 
            transform: skewX(-15deg); 
            color: white; 
        }
        
        .badge-master { 
            position: absolute; 
            top: 0; 
            right: 0; 
            background: var(--rouge-vif); 
            color: white; 
            font-size: 8px; 
            padding: 5px 12px; 
            z-index: 20; 
            font-weight: bold; 
        }

        .master-controls { 
            margin-top: 12px; 
            padding-top: 10px; 
            border-top: 1px solid #311; 
            display: flex; 
            gap: 10px; 
        }
        
        .btn-edit { background: var(--rouge-vif); color: white; border: none; padding: 5px 10px; font-size: 9px; font-weight: bold; cursor: pointer; }
        .btn-del { background: #300; color: #999; border: none; padding: 5px 10px; font-size: 9px; font-weight: bold; cursor: pointer; }

        /* LOADING TERMINAL ROUGE */
        #loading-overlay { 
            position: fixed; 
            inset: 0; 
            background: black; 
            z-index: 20000; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            color: var(--rouge-vif); 
        }
        
        .bar-container { width: 300px; height: 2px; background: #200; margin-top: 20px; }
        .bar-fill { height: 100%; background: var(--rouge-vif); width: 0%; transition: 0.1s; box-shadow: 0 0 10px var(--rouge-vif); }
    </style>
</head>
<body onload="bootSystem()">

    <div id="loading-overlay">
        <div id="boot-logs" style="font-size: 10px; width: 400px; height: 100px; overflow: hidden; margin-bottom: 20px; color: #600;"></div>
        <div style="font-size: 12px; letter-spacing: 5px;">INITIALIZING_DATABASE_V2031</div>
        <div class="bar-container"><div id="load-bar" class="bar-fill"></div></div>
    </div>

    <div class="osd-header">
        <a href="index.html" class="btn-exit">EXIT_ARCHIVE</a>
        <div style="text-align: center;">
            <div style="font-size: 11px; letter-spacing: 4px; color: var(--rouge-vif);">NÃ‰BULEUSE VISUELLE V2031</div>
            <div id="hidden-trigger" ondblclick="toggleMaster()" style="font-size: 8px; color: #400; cursor:default; user-select:none;">
                SYS_TIME: <span id="clock-display">00:00:00</span> | VRAM: <span id="vram-usage">0MB</span>
            </div>
        </div>
        <div id="status-tag" style="font-size: 10px; color: #300;">PROTECTED_MODE</div>
    </div>

    <div class="sys-log" id="sys-log">
        [SYSTEM] STANDBY...<br>
        [SIGNAL] STABLE<br>
        [DATA] ENCRYPTED
    </div>

    <div class="nav-planets">
        <div class="planet-box" onclick="setFilter('Fan-Cosplay', this)"><div class="planet p-gold"></div><span class="planet-label">SECTEUR_COSPLAY</span></div>
        <div class="planet-box" onclick="setFilter('World', this)"><div class="planet p-blue"></div><span class="planet-label">GEOGRAPHIE_ALPHA</span></div>
        <div class="planet-box" onclick="setFilter('Livre', this)"><div class="planet p-red"></div><span class="planet-label">ARCHIVES_LITTERAIRES</span></div>
    </div>

    <div class="nebula-layer"></div><div class="star-field"></div>

    <div id="app-container" style="display:none; opacity: 0; transition: 1.5s ease;">
        <div class="container">
            <h1 class="glitch-title">NÃ©buleuse_Archives</h1>
            
            <div id="master-tools">
                <h2 style="color: var(--cosplay-gold); border-bottom: 1px solid var(--rouge-vif); margin-bottom:20px;">[ OMNI_COMMANDER : HINARU ]</h2>
                <div class="master-grid">
                    <div class="calendar-tool" style="background: rgba(0,0,0,0.5); padding: 15px; border: 1px solid var(--bordeaux);">
                        <label style="font-size:10px; color:var(--rouge-vif);">CYCLE DE PUBLICATION (TOME 1-14)</label>
                        <select id="tome-selector" style="width:100%; background: #200; color: white; border: 1px solid var(--rouge-vif); margin: 10px 0; padding:5px;">
                            <option value="1">TOME I : LES ORIGINES</option>
                            <option value="2">TOME II : L'ASTRE S'Ã‰VEILLE</option>
                            <option value="14">TOME XIV : LE CRÃ‰ATEUR SUPRÃŠME</option>
                        </select>
                        <label style="font-size:10px; color:var(--rouge-vif);">DATE PRÃ‰VUE (CALENDRIER 2031)</label>
                        <input type="date" id="pub-date" value="2031-03-05" style="width:100%; background: #200; color: white; border: 1px solid var(--rouge-vif); padding:5px;">
                        <button class="btn-master" onclick="savePublication()">[ PROGRAMMER SIGNAL ]</button>
                        <div id="publication-log" style="font-size: 10px; margin-top: 20px; color: var(--cosplay-gold);">> PRÃŠT POUR INJECTION...</div>
                    </div>

                    <div class="3d-viewer-container" style="border: 1px solid var(--bordeaux); background: #000; position: relative;">
                        <div id="canvas-3d" class="canvas-3d"></div>
                        <div style="position: absolute; bottom: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between;">
                            <input type="file" id="blender-file" accept=".glb,.gltf" style="display:none;" onchange="loadBlenderModel(event)">
                            <button class="btn-master" onclick="document.getElementById('blender-file').click()">[ CHARGER OBJET 3D (GLB) ]</button>
                            <span id="obj-info" style="font-size: 9px; align-self: center; color:var(--cosplay-gold);">AUCUN MODÃˆLE DÃ‰TECTÃ‰</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="romans-selector"></div>

            <div class="search-container">
                <span style="font-size: 10px; color: var(--rouge-vif);">> SEARCH:</span>
                <input type="text" id="search" oninput="loadData()" placeholder="..." spellcheck="false">
                <div style="flex-grow: 1;"></div>
                <div style="font-size: 9px; color: #555;">MODE : <span id="mode-indicator" style="color:white;">LECTURE SEULE</span></div>
            </div>

            <div id="main-grid" class="archive-grid"></div>
        </div>
    </div>

    <script>
        const SYSTEM_CONFIG = { version: "100.9.30", githubUser: "Hinaru", githubRepo: "Nebula" };

        const STATE = {
            isMaster: new URLSearchParams(window.location.search).get('Hinaru') === 'true',
            projet: new URLSearchParams(window.location.search).get('projet') || 1,
            filter: null,
            romans: [
                { id: 1, title: "SHADRASY: Le Souffle Originel", tomes: 154, date: "05/03/2031", public: true },
                { id: 2, title: "NÃ©buleuse Alpha", tomes: 96, date: "02/2032", public: false },
                { id: 14, title: "Projet Final XIV", tomes: 14, date: "2036", public: false }
            ]
        };

        let scene, camera, renderer, loader, currentModel;

        function init3D() {
            const container = document.getElementById('canvas-3d');
            if(!container) return;
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1.5);
            scene.add(light);
            camera.position.z = 5;
            loader = new THREE.GLTFLoader();
            animate3D();
        }

        function animate3D() {
            requestAnimationFrame(animate3D);
            if(currentModel) currentModel.rotation.y += 0.01;
            renderer.render(scene, camera);
        }

        function loadBlenderModel(event) {
            const file = event.target.files[0];
            const url = URL.createObjectURL(file);
            document.getElementById('obj-info').innerText = "CHARGEMENT : " + file.name;
            loader.load(url, function(gltf) {
                if(currentModel) scene.remove(currentModel);
                currentModel = gltf.scene;
                currentModel.scale.set(1.5, 1.5, 1.5);
                scene.add(currentModel);
                document.getElementById('obj-info').innerText = "MODÃˆLE ACTIF : " + file.name;
            });
        }

        function logMessage(msg, type) {
            const logPanel = document.getElementById('sys-log');
            if(!logPanel) return;
            const timestamp = new Date().toLocaleTimeString().split(' ')[0];
            logPanel.innerHTML = `[${timestamp}] [${type}] ${msg}<br>` + logPanel.innerHTML;
        }

        function bootSystem() {
            const logs = document.getElementById('boot-logs');
            const messages = [
                "> INITIALIZING KERNEL...", 
                STATE.isMaster ? "> MASTER_ACCESS_GRANTED" : "> PUBLIC_RESTRICTIONS_APPLIED",
                "> LOADING NEBULA_DATA.SYS", 
                "> VERIFYING BRIDGE_SECURITY...",
                "> CONNECTING TO SECTOR R-" + STATE.projet,
                "> SYSTEM READY."
            ];
            let i = 0;
            const interval = setInterval(() => {
                if (i < messages.length) {
                    logs.innerHTML += messages[i] + "<br>";
                    document.getElementById('load-bar').style.width = ((i+1) * (100/messages.length)) + "%";
                    i++;
                } else {
                    clearInterval(interval);
                    document.getElementById('loading-overlay').style.display = 'none';
                    document.getElementById('app-container').style.display = 'block';
                    setTimeout(() => { document.getElementById('app-container').style.opacity = '1'; }, 100);
                    initApp();
                }
            }, 300);
            setInterval(() => {
                document.getElementById('clock-display').innerText = new Date().toLocaleTimeString();
            }, 1000);
        }

        function initApp() {
            if (STATE.isMaster) {
                document.getElementById('master-tools').style.display = 'block';
                document.getElementById('status-tag').style.color = "var(--rouge-vif)";
                document.getElementById('status-tag').innerText = "FULL_ADMIN_ACCESS";
                document.getElementById('mode-indicator').innerText = "MAINTENANCE_MASTER";
                init3D();
            }
            renderRomans();
            loadData();
            logMessage("DATABASE_ONLINE", "SUCCESS");
        }

        function savePublication() {
            const tome = document.getElementById('tome-selector').value;
            const date = document.getElementById('pub-date').value;
            const log = document.getElementById('publication-log');
            log.innerHTML += `<br>> SIGNAL PROGRAMMÃ‰ : TOME ${tome} LE ${date}`;
            const plan = JSON.parse(localStorage.getItem('hinaru_planning') || "[]");
            plan.push({ tome, date, status: "WAITING" });
            localStorage.setItem('hinaru_planning', JSON.stringify(plan));
        }

        function renderRomans() {
            const selector = document.getElementById('romans-selector');
            selector.innerHTML = STATE.romans.map(r => {
                if (!r.public && !STATE.isMaster) return '';
                return `
                    <div class="roman-tab ${STATE.projet == r.id ? 'active' : ''} ${!r.public ? 'master-only' : ''}" onclick="changeProjet(${r.id})">
                        <span style="letter-spacing:1px; font-weight:bold;">R-${r.id}: ${r.title.toUpperCase()}</span>
                        <span class="tome-info">${r.tomes} UNITÃ‰S | ${r.date}</span>
                    </div>
                `;
            }).join('');
        }

        function changeProjet(id) {
            const url = new URL(window.location);
            url.searchParams.set('projet', id);
            window.location.href = url.href;
        }

        function toggleMaster() {
            const url = new URL(window.location);
            if (STATE.isMaster) url.searchParams.delete('Hinaru');
            else url.searchParams.set('Hinaru', 'true');
            window.location.href = url.href;
        }

        function setFilter(type, el) {
            document.querySelectorAll('.planet').forEach(p => p.classList.remove('active'));
            if (STATE.filter === type) {
                STATE.filter = null;
                logMessage("FILTER_CLEARED", "INFO");
            } else {
                STATE.filter = type;
                el.querySelector('.planet').classList.add('active');
                logMessage("FILTER_SET: " + type, "ACTION");
            }
            loadData();
        }

        function loadData() {
            const mainGrid = document.getElementById('main-grid');
            const searchVal = document.getElementById('search').value.toLowerCase();
            mainGrid.innerHTML = "";
            if (typeof archivesData === 'undefined') {
                logMessage("DATA_NOT_FOUND", "ERROR");
                return;
            }
            const filtered = archivesData.filter(item => {
                const matchProjet = item.roman == STATE.projet;
                const matchType = !STATE.filter || item.type === STATE.filter;
                const matchSearch = !searchVal || item.nom.toLowerCase().includes(searchVal);
                if (item.prive && !STATE.isMaster) return false;
                return matchProjet && matchType && matchSearch;
            });
            filtered.forEach(item => {
                mainGrid.appendChild(createComplexCard(item));
            });
            document.getElementById('vram-usage').innerText = (filtered.length * 12.4).toFixed(1) + "MB";
        }

        function createComplexCard(item) {
            const box = document.createElement('div');
            box.className = 'box';
            if (item.prive) box.style.border = "1px dashed var(--bordeaux)";
            const is3D = item.glb && item.glb !== "";
            let mediaHTML = "";
            if (is3D) {
                mediaHTML = `<model-viewer src="${item.glb}" camera-controls auto-rotate shadow-intensity="1" style="width:100%; height:100%;"></model-viewer>`;
            } else if (item.isFolder) {
                mediaHTML = `<div style="width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; background:rgba(255,0,0,0.05); cursor:pointer;">
                                <img src="${item.url}" style="width:100%; height:100%; object-fit:cover; opacity:0.3; filter:grayscale(1) sepia(1) hue-rotate(-50deg);">
                                <div style="position:absolute; bottom:20px; font-size:9px; color:var(--rouge-vif); font-weight:bold;">ðŸ“‚ OPEN_DIR</div>
                             </div>`;
            } else {
                mediaHTML = `<img src="${item.url}" style="width:100%; height:100%; object-fit:cover;" loading="lazy">`;
            }
            box.innerHTML = `
                <div class="card-hud">FILE_ID: ${item.id || 'N/A'}<br>${item.prive ? 'SECURED_DATA' : 'PUBLIC_DATA'}</div>
                <div class="scanline"></div>
                ${item.inedit ? '<div class="badge-inedit">INÃ‰DIT</div>' : ''}
                ${item.prive ? '<div class="badge-master">PRIVE</div>' : ''}
                <div class="image-frame">${mediaHTML}</div>
                <div style="padding-top:15px;">
                    <span style="color:var(--rouge-vif); font-size:8px; letter-spacing:1px;">[ ${item.type.toUpperCase()} ]</span>
                    <div style="font-size:14px; color:white; font-weight:bold; margin-top:3px;">${item.nom}</div>
                    ${STATE.isMaster ? `
                        <div class="master-controls">
                            <button class="btn-edit">EDIT</button>
                            <button class="btn-del">DEL</button>
                            <span style="font-size:7px; color:var(--cosplay-gold); align-self:center;">V2031_RECOVERY_ON</span>
                        </div>
                    ` : ''}
                </div>
            `;
            return box;
        }
    </script>
</body>
</html>
